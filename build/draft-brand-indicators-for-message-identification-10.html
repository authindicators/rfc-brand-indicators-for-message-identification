<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Brand Indicators for Message Identification (BIMI)</title>
<meta content="Seth Blank" name="author">
<meta content="Peter Goldstein" name="author">
<meta content="Thede Loder" name="author">
<meta content="Terry Zink" name="author">
<meta content="Marc Bradshaw" name="author">
<meta content="Alex Brotman (ed)" name="author">
<meta content="
       Brand Indicators for Message Identification (BIMI) permits Domain Owners
to coordinate with Mail User Agents (MUAs) to display brand-specific
Indicators next to properly authenticated messages.  There are two aspects
of BIMI coordination: a scalable mechanism for Domain Owners to publish
their desired Indicators, and a mechanism for Mail Transfer Agents (MTAs)
to verify the authenticity of the Indicator.  This document specifies how
Domain Owners communicate their desired Indicators through the BIMI Assertion
Record in DNS and how that record is to be interpreted by MTAs and MUAs. MUAs
and mail-receiving organizations are free to define their own policies for making
use of BIMI data and for Indicator display as they see fit. 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="draft-brand-indicators-for-message-identification-10" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.10.12
    weasyprint 54.1
-->
<link href="build/draft-brand-indicators-for-message-identification.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BIMI</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Blank, et al.</td>
<td class="center">Expires 7 March 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-brand-indicators-for-message-identification-10</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-03" class="published">3 September 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-03-07">7 March 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Blank</div>
<div class="org">Valimail</div>
</div>
<div class="author">
      <div class="author-name">P. Goldstein</div>
<div class="org">Valimail</div>
</div>
<div class="author">
      <div class="author-name">T. Loder (ed)</div>
<div class="org">Skye Logicworks LLC</div>
</div>
<div class="author">
      <div class="author-name">T. Zink (ed)</div>
</div>
<div class="author">
      <div class="author-name">M. Bradshaw (ed)</div>
<div class="org">Fastmail</div>
</div>
<div class="author">
      <div class="author-name">A. Brotman (ed)</div>
<div class="org">Comcast</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Brand Indicators for Message Identification (BIMI)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Brand Indicators for Message Identification (BIMI) permits Domain Owners
to coordinate with Mail User Agents (MUAs) to display brand-specific
Indicators next to properly authenticated messages.  There are two aspects
of BIMI coordination: a scalable mechanism for Domain Owners to publish
their desired Indicators, and a mechanism for Mail Transfer Agents (MTAs)
to verify the authenticity of the Indicator.  This document specifies how
Domain Owners communicate their desired Indicators through the BIMI Assertion
Record in DNS and how that record is to be interpreted by MTAs and MUAs. MUAs
and mail-receiving organizations are free to define their own policies for making
use of BIMI data and for Indicator display as they see fit.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 7 March 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-high-level-goals" class="xref">High-Level Goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-security" class="xref">Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-out-of-scope" class="xref">Out of Scope</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-terminology-and-definitions" class="xref">Terminology and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-bimi-assertion" class="xref">BIMI Assertion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-indicator" class="xref">Indicator</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-mark-verifying-authority-mv" class="xref">Mark Verifying Authority (MVA)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-bimi-evidence-document" class="xref">BIMI Evidence Document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-mark-certificate-mc" class="xref">Mark Certificate (MC)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-verified-mark-certificate-v" class="xref">Verified Mark Certificate (VMC)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-common-mark-certificate-cmc" class="xref">Common Mark Certificate (CMC)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-protocol-client" class="xref">Protocol Client</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-verifying-protocol-client" class="xref">Verifying Protocol Client</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-local-part" class="xref">Local-part</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-bimi-dns-records" class="xref">BIMI DNS Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-mua-obligations" class="xref">MUA Obligations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-personal-avatars-and-bimi" class="xref">Personal Avatars and BIMI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-assertion-record-definition" class="xref">Assertion Record Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-declination-to-publish" class="xref">Declination to Publish</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-supported-image-formats-for" class="xref">Supported Image Formats for l= tag</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-selectors" class="xref">Selectors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-local-part-selectors" class="xref">Local-part Selectors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-bimi-header-fields" class="xref">BIMI Header Fields</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-bimi-selector-header" class="xref">BIMI-Selector Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-bimi-location-header" class="xref">BIMI-Location Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-bimi-indicator-header" class="xref">BIMI-Indicator Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-bimi-logo-preference-header" class="xref">BIMI-Logo-Preference Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-header-signing" class="xref">Header Signing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-header-removal" class="xref">Header Removal</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-domain-owner-actions" class="xref">Domain Owner Actions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-determine-and-publish-indic" class="xref">Determine and Publish Indicator(s) for Use</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-publish-assertion-records" class="xref">Publish Assertion Records</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-manage-multiple-uses-of-the" class="xref">Manage multiple uses of the same Indicator(s) within a trust boundary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-set-the-headers-on-outgoing" class="xref">Set the headers on outgoing email as appropriate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-receiver-actions" class="xref">Receiver Actions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-authentication-requirements" class="xref">Authentication Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-assertion-record-discovery" class="xref">Assertion Record Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-indicator-discovery" class="xref">Indicator Discovery.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-indicator-discovery-with-ev" class="xref">Indicator Discovery With Evidence.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-indicator-discovery-without" class="xref">Indicator Discovery Without Evidence.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-indicator-validation" class="xref">Indicator Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-affix-bimi-status-to-authen" class="xref">Affix BIMI Status to Authentication Results Header Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-handle-existing-bimi-locati" class="xref">Handle Existing BIMI-Location and BIMI-Indicator Headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-construct-bimi-location-uri" class="xref">Construct BIMI-Location URI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="xref">7.10</a>. <a href="#name-construct-bimi-indicator-he" class="xref">Construct BIMI-Indicator header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="xref">7.11</a>. <a href="#name-construct-bimi-logo-prefere" class="xref">Construct BIMI-Logo-Preference header</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-indirect-mail-flows" class="xref">Indirect Mail Flows</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-lookalike-domains-and-copyc" class="xref">Lookalike Domains and Copycat Indicators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-large-files-and-buffer-over" class="xref">Large files and buffer overflows</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-slow-dns-queries" class="xref">Slow DNS queries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-unaligned-indicators-and-as" class="xref">Unaligned Indicators and asserting domains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-unsigned-bimi-selector-head" class="xref">Unsigned BIMI-Selector Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-cgi-scripts-in-indicator-pa" class="xref">CGI scripts in Indicator payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-metadata-in-indicators" class="xref">Metadata in Indicators</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-permanent-header-field-upda" class="xref">Permanent Header Field Updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-registry-for-supported-bimi" class="xref">Registry for Supported BIMI Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-other-iana-needs" class="xref">Other IANA needs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-under-discussion" class="xref">Under Discussion</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-example-selector-discovery-" class="xref">Example Selector Discovery (INFORMATIVE)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-no-bimi-selector-header" class="xref">No BIMI-Selector Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-with-bimi-selector-header" class="xref">With BIMI-Selector Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-without-bimi-selector-heade" class="xref">Without BIMI-Selector Header on a subdomain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-with-bimi-selector-header-o" class="xref">With BIMI-Selector Header on a subdomain</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#appendix-A.5" class="xref">A.5</a>.  <a href="#name-invalid-bimi-selector-heade" class="xref">Invalid BIMI-Selector Header</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-example-authentication-resu" class="xref">Example Authentication-Results entry (INFORMATIONAL)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-successful-bimi-lookup" class="xref">Successful BIMI lookup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-no-bimi-record" class="xref">No BIMI record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-declination-to-publish-2" class="xref">Declination to Publish</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-B.4" class="xref">B.4</a>.  <a href="#name-subdomain-has-no-default-re" class="xref">Subdomain has no default record, but organizational domain does</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#appendix-B.5" class="xref">B.5</a>.  <a href="#name-subdomain-and-organizationa" class="xref">Subdomain and organizational domain have no record for selector, but organization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#appendix-B.6" class="xref">B.6</a>.  <a href="#name-subdomain-has-no-record-for" class="xref">Subdomain has no record for selector, but organization domain does</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-example-bimi-headers-constr" class="xref">Example BIMI Headers Construction (INFORMATIONAL)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-mta-receives-an-email" class="xref">MTA Receives an email</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-mta-does-its-authentication" class="xref">MTA does its authentication checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-mta-performs-bimi-assertion" class="xref">MTA performs BIMI Assertion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-mta-appends-to-authenticati" class="xref">MTA appends to Authentication-Results</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#appendix-C.5" class="xref">C.5</a>.  <a href="#name-mta-constructs-bimi-locatio" class="xref">MTA Constructs BIMI-Location and BIMI-Indicator headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#appendix-C.6" class="xref">C.6</a>.  <a href="#name-the-mua-displays-the-indica" class="xref">The MUA displays the Indicator</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH BEFORE PUBLISHING:
The source for this draft is maintained in GitHub at:
<a href="https://github.com/BLAHBLAHBLAH">https://github.com/BLAHBLAHBLAH</a><a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document defines Brand Indicators for Message Identification (BIMI),
which enables Domain Owners to coordinate with Mail Box Providers (MBPs),
Mail Transfer Agents (MTAs), and Mail User Agents (MUAs) in the display of
brand-specific Indicators next to properly authenticated messages.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">BIMI is designed to be open and to work at Internet scale.  BIMI is
intended to drive adoption of email authentication best practices by
leveraging existing DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> policies, the supporting authentication
methods DKIM <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span> and SPF <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span>, and other associated standards
such as ARC <span>[<a href="#RFC8617" class="xref">RFC8617</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The approach taken by BIMI is heavily influenced by the approach taken
in DKIM <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>, in that BIMI:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">has no dependency on the deployment of any new Internet protocols or
services for indicator registration or revocation;<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.2">makes no attempt to include encryption as part of the mechanism;<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.3">is compatible with the existing email infrastructure and transparent
to the fullest extent possible;<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.4">requires minimal new infrastructure;<a href="#section-1-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.5">can be implemented independently of clients in order to reduce
deployment time;<a href="#section-1-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.6">can be deployed incrementally; and<a href="#section-1-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.7">allows delegation of indicator hosting to third parties.<a href="#section-1-5.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-6">To participate in BIMI, Domain Owners MUST have a strong [DMARC] policy
(quarantine or reject) on both the Organizational Domain, and the RFC5322.From
Domain of the message. Quarantine policies MUST NOT have a pct less than pct=100.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document defines how Domain Owners specify their desired indicators
through the BIMI Assertion Record in DNS and how that record is to be
interpreted by MTAs and MUAs.  This document does not cover how domains
or indicators are verified, how MUAs should display the indicators, or
how other protocols (i.e. IMAP, JMAP) can be extended to work with BIMI.
Other documents may cover these topics.  MUAs and Mail Box Providers (MBPs)
are free to define their own policies for making use of BIMI data and for
indicator display as they see fit.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="why-bimi">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">The Sender Policy Framework (SPF <span>[<a href="#RFC7208" class="xref">RFC7208</a>]</span>), DomainKeys Identified Mail (DKIM
<span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>), "Domain-based Message Authentication, Reporting, and Conformance"
(DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span>), and Authenticated Received Chain (ARC <span>[<a href="#RFC8617" class="xref">RFC8617</a>]</span>) provide
mechanisms for domain-level authentication of email messages.  They enable
cooperating email senders and receivers to distinguish messages that are authorized
to use the domain name from those that are not. BIMI relies on these authentication
protocols, but is not a new authentication protocol itself.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">MUAs are increasingly incorporating graphical Indicators to indicate the identity
of the sender of a message.  While a discussion of the merits of doing this is beyond
the scope of this document, at present there are no open standards for publishing
and aiding discovery of preferred Indicators or for tying display of them to authentic
messages only.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Because of the desire to have brand-specific Indicators available, some
mail-receiving organizations have developed closed systems for obtaining
and displaying Brand Indicators for select domains.  While this has enabled
these mail-receiving organizations to display brand Indicators for a limited
subset of messages, this closed approach has a number of downsides:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-4">
<li id="section-2-4.1">It puts a significant burden on each mail-receiving organization, because
they must identify and manage a large database of Brand Indicators.<a href="#section-2-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.2">Scalability is challenging for closed systems that attempt to capture and
maintain complete sets of data across the whole of the Internet.<a href="#section-2-4.2" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.3">A lack of uniformity across different mail-receiving organizations - each
organization will have its own Indicator set, which may or may not agree with
those maintained by other organizations for any given domain.<a href="#section-2-4.3" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.4">Domain Owners have limited ability to influence the Brand Indicator for the
domain(s) they own, and any ability they do have is likely to be dependent upon
direct coordination with each of many mail-receiving organizations.<a href="#section-2-4.4" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.5">Many Domain Owners have no ability to participate whatsoever as they do not
have the appropriate relationships to coordinate with mail-receiving organizations.<a href="#section-2-4.5" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.6">MUAs that are not associated with a particular mail-receiving organization
are likely to be disadvantaged, because they are unlikely to receive Indicators
in a standardized manner or optimized for their user interfaces.<br><a href="#section-2-4.6" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-2-5">This shows the need for a standardized mechanism by which Domain Owners interested
in ensuring that their Indicators are displayed correctly and appropriately can
publish and distribute Brand Indicators for use by any participating MUA.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">BIMI removes the substantial burden of curating and maintaining an Indicator
database from MUAs and MBPs, and allows each domain owner to manage their own
Indicators.  As an additional benefit, mail-originating organizations are
incentivized to authenticate their email as doing so will enable them to
influence how email and Indicators from the organization are displayed.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">The structure of BIMI is as follows:<a href="#section-2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-8">
<li id="section-2-8.1">
          <p id="section-2-8.1.1">Domain Owners:<a href="#section-2-8.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-8.1.2.1">
              <p id="section-2-8.1.2.1.1">Fully implement the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> mechanism, to include:<a href="#section-2-8.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-8.1.2.1.2.1">
                  <p id="section-2-8.1.2.1.2.1.1">Creating and publishing in DNS <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> a DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> policy record
that meets the following criteria:<a href="#section-2-8.1.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-8.1.2.1.2.1.2.1">The policy record MUST express either a Requested Mail Receiver
policy of "quarantine" with an effective percentage of 100%, or a
Requested Mail Receiver policy of "reject" (with any percentage value).<a href="#section-2-8.1.2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-2-8.1.2.1.2.1.2.2">If a subdomain policy is published it MUST NOT be "none"<a href="#section-2-8.1.2.1.2.1.2.2" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-2-8.1.2.1.2.1.2.3">Be published for the Organizational Domain, and any subdomains thereof<a href="#section-2-8.1.2.1.2.1.2.3" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-2-8.1.2.1.2.2">Deploying authentication technologies to ensure Identifier Alignment<a href="#section-2-8.1.2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-2-8.1.2.2">Publish their preferred Brand Indicators via the DNS <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>.<a href="#section-2-8.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-2-8.2">Senders: Ensure mail is properly authenticated, and has a sufficiently
strict DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> policy.<a href="#section-2-8.2" class="pilcrow">¶</a>
</li>
        <li id="section-2-8.3">
          <p id="section-2-8.3.1">MTAs and MBPs:<a href="#section-2-8.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-8.3.2.1">Confirm authenticity of the message using DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> and whatever other
authentication mechanisms they wish to apply.<a href="#section-2-8.3.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-8.3.2.2">Check for a corresponding BIMI record, obtaining references to the
indicator media and optional substantiation of indicator ownership rights<a href="#section-2-8.3.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2-8.3.2.3">If both the message is authentic and the logo is deemed acceptable, the
receiver adds a header to the message which can be used by the MUA to
obtain the Domain Owner's preferred brand indicator.<a href="#section-2-8.3.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-2-8.4">MUA: retrieves and displays the brand indicator as appropriate based on
its policy and user interface.<a href="#section-2-8.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-2-9">The purpose of this structure is to reduce operational complexity at each step.
It is also to consolidate validation and Indicator selection operations into the
MTA, so that Domain Owners need only publish a few simple records and MUAs only
need simple display logic.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">It is expected that MBPs implementing BIMI will do so in both their MTAs and MUAs.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">#Requirements   {#requirements}<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">Specification of BIMI in this document is guided by the following high-level goals,
security dependencies, detailed requirements, and items that are documented as out of scope.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">An overview of the security challenges and design decisions is documented at <span>[<a href="#BIMI-OVERVIEW" class="xref">BIMI-OVERVIEW</a>]</span>.<a href="#section-2-13" class="pilcrow">¶</a></p>
<div id="goals">
<section id="section-2.1">
        <h3 id="name-high-level-goals">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-high-level-goals" class="section-name selfRef">High-Level Goals</a>
        </h3>
<p id="section-2.1-1">BIMI has the following high-level goals:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">Allow Domain Owners to suggest appropriate Indicators for display with authenticated
messages originating from their domains.<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.2">Enable the authors of MUAs to display meaningful Indicators associated with the Domain
Owner to recipients of authenticated email.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.3">Provide mechanisms to prevent attempts by malicious Domain Owners to fraudulently
represent messages from their domains as originating with other entities.<a href="#section-2.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.4">Work at Internet Scale.<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.5">Encourage the adoption of Email Authentication Best Practices.<a href="#section-2.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="security">
<section id="section-2.2">
        <h3 id="name-security">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-security" class="section-name selfRef">Security</a>
        </h3>
<p id="section-2.2-1">Brand Indicators are a potential vector for abuse.  BIMI creates a relationship between
sending organization and Mail Receiver so that the receiver can display appropriately
designated Indicators if the sending domain is verified and has meaningful reputation
with the receiver.  Without verification and reputation, there is no way to prevent a
bad actor exxample.com from using example.com's Brand Indicators and behaving maliciously.
This document does not cover the different verification and reputation mechanisms available,
but BIMI relies upon them to be in deployed in order to control abuse.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="out-of-scope">
<section id="section-2.3">
        <h3 id="name-out-of-scope">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-out-of-scope" class="section-name selfRef">Out of Scope</a>
        </h3>
<p id="section-2.3-1">Several topics and issues are specifically out of scope for the initial version of this work.
These include the following:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">Publishing policy other than via the DNS.<a href="#section-2.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.2">Specific requirements for Indicator display on MUAs.<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.3">The explicit mechanisms used by Verifying Protocol Clients - this will be deferred to a later document.<a href="#section-2.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology-and-definitions" class="section-name selfRef">Terminology and Definitions</a>
      </h2>
<p id="section-3-1">This section defines terms used in the rest of the document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in
<a href="https://tools.ietf.org/html/bcp14">BCP 14</a> <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Readers are encouraged to be familiar with the contents of <span>[<a href="#RFC5598" class="xref">RFC5598</a>]</span>.
In particular, that document defines various roles in the messaging
infrastructure that can appear the same or separate in various contexts.
For example, a Domain Owner could, via the messaging mechanisms on which
BIMI is based, delegate responsibility for providing preferred brand
indicators to a third party with another role.  This document does not
address the distinctions among such roles; the reader is encouraged to
become familiar with that material before continuing.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Syntax descriptions use Augmented BNF (ABNF) <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">"Author Domain", "Domain Owner", "Organizational Domain", and "Mail Receiver"
are imported from DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> Section 3.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="bimi-assertion">
<section id="section-3.1">
        <h3 id="name-bimi-assertion">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-bimi-assertion" class="section-name selfRef">BIMI Assertion</a>
        </h3>
<p id="section-3.1-1">The mechanism through which a Protocol Client verifies the BIMI Assertion
Record and constructs the URI(s) to the requested Indicator(s) to be placed
in the BIMI-Location header.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="indicator">
<section id="section-3.2">
        <h3 id="name-indicator">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-indicator" class="section-name selfRef">Indicator</a>
        </h3>
<p id="section-3.2-1">The icon, logo, image, mark, or other graphical representation of the brand. The
Indicator is defined in a common image format with restrictions detailed in the
<a href="#assertion-record-definition">Assertion Record Definition</a>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mark-verifying-authority-mva">
<section id="section-3.3">
        <h3 id="name-mark-verifying-authority-mv">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-mark-verifying-authority-mv" class="section-name selfRef">Mark Verifying Authority (MVA)</a>
        </h3>
<p id="section-3.3-1">An entity or organization that can provide evidence of verification of Indicators
asserted by a Domain Owner to Verifying Protocol Clients.  The MVA may choose to
uphold and confirm the meeting of certain Indicator standards (i.e., size, trademark,
content, etc).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bimi-evidence-document">
<section id="section-3.4">
        <h3 id="name-bimi-evidence-document">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-bimi-evidence-document" class="section-name selfRef">BIMI Evidence Document</a>
        </h3>
<p id="section-3.4-1">A document published by a Mark Verifying Authority to assert evidence of verification.
These are defined in a separate document.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mark-certificate-mc">
<section id="section-3.5">
        <h3 id="name-mark-certificate-mc">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-mark-certificate-mc" class="section-name selfRef">Mark Certificate (MC)</a>
        </h3>
<p id="section-3.5-1">A certificate issued by a Certificate Authority in accordance with the Minimum
Security Requirements for Issuance of Mark Certificates.  These requirements are
defined in a separate document.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">A Mark Certificate is one type of a BIMI Evidence Document, and there are two
types of Mark Certificates.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<div id="verified-mark-certificate-vmc">
<section id="section-3.5.1">
          <h4 id="name-verified-mark-certificate-v">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-verified-mark-certificate-v" class="section-name selfRef">Verified Mark Certificate (VMC)</a>
          </h4>
<p id="section-3.5.1-1">A Verified Mark Certificate is an MC issued by an MVA in support of BIMI Indicators
that are representations of either Registered Trademarks or Government Marks.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="common-mark-certificate-cmc">
<section id="section-3.5.2">
          <h4 id="name-common-mark-certificate-cmc">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-common-mark-certificate-cmc" class="section-name selfRef">Common Mark Certificate (CMC)</a>
          </h4>
<p id="section-3.5.2-1">A Common Mark Certificate is an MC issued by an MVA in support of BIMI Indicators
that are representations either of Prior Use Marks or Modifications of Registered
Trademarks.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-client">
<section id="section-3.6">
        <h3 id="name-protocol-client">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-protocol-client" class="section-name selfRef">Protocol Client</a>
        </h3>
<p id="section-3.6-1">An entity designed to obtain and correctly interpret the records defined in this
specification for the purpose of discovering and fetching published Indicators.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-protocol-client">
<section id="section-3.7">
        <h3 id="name-verifying-protocol-client">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-verifying-protocol-client" class="section-name selfRef">Verifying Protocol Client</a>
        </h3>
<p id="section-3.7-1">A Protocol Client that uses optional capabilities to obtain and evaluate evidence
concerning the Domain Owner's rights to use the published Indicators.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local-part">
<section id="section-3.8">
        <h3 id="name-local-part">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-local-part" class="section-name selfRef">Local-part</a>
        </h3>
<p id="section-3.8-1">The locally interpret string part of an email address which appears before the
at-sign character ("@", ASCII value 64) which is then followed by an Internet
domain.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bimi-dns">
<section id="section-4">
      <h2 id="name-bimi-dns-records">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-bimi-dns-records" class="section-name selfRef">BIMI DNS Records</a>
      </h2>
<p id="section-4-1">Domain owners publish BIMI policies by adding BIMI Assertion Records in the
DNS as TXT records.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Published policies are interpreted and applied by Protocol Clients.  A Domain Owner
signals intended BIMI participation for one or more of its domains by publishing an
Assertion Record in a subdomain under it.  In doing so, Domain Owners make specific
requests of MUAs regarding the preferred set of Indicators to be displayed with
messages that are confirmed to be authorized to appear from the Domain Owner's domain.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The use of BIMI is opt-in.  Receivers default to performing no BIMI-specific message
handling until they choose to do so, and then only if a BIMI record for the sender's
domain is found.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">BIMI's use of the DNS is driven in part by BIMI's use of domain names as the basis of
sender identity and message authentication. Use of the DNS as the policy publication
service also has the benefit of reusing an extremely well-established operations,
administration, and management infrastructure, rather than creating a new one.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">BIMI's policy payload is intentionally only published via a DNS record and not via
one or more email headers. This serves three purposes:<a href="#section-4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-6">
<li id="section-4-6.1">There is one and only one mechanism for both simple and complex policies to be published.<a href="#section-4-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-6.2">Operational complexity is reduced.  MTAs only need to check a single record in a consistent
manner to discover and enforce policy.<a href="#section-4-6.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-6.3">Indicators SHOULD be verified and cached in advance, so that malicious headers cannot be
used as an attack vector.<a href="#section-4-6.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-4-7">Per DNS <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>, a TXT record can comprise several "character-string" objects.
BIMI TXT records with multiple strings must be treated in an identical
manner to <a href="https://tools.ietf.org/html/rfc7208#section-3.3">SPF Section 3.3</a>.<a href="#section-4-7" class="pilcrow">¶</a></p>
<div id="mua_guidance">
<section id="section-4.1">
        <h3 id="name-mua-obligations">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-mua-obligations" class="section-name selfRef">MUA Obligations</a>
        </h3>
<p id="section-4.1-1">MUAs implementing the BIMI mechanism SHOULD make a best-effort attempt to adhere
to the Domain Owner's published BIMI policy.  However, MUAs have final control
over the user interface published to their end users, and MAY use alternate
Indicators than those specified in the BIMI assertion record or no Indicator at
all.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="personal_avatars">
<section id="section-4.2">
        <h3 id="name-personal-avatars-and-bimi">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-personal-avatars-and-bimi" class="section-name selfRef">Personal Avatars and BIMI</a>
        </h3>
<p id="section-4.2-1">Some mailbox providers both participate in BIMI and offer the option of showing
personal avatars associated with the sender of an email message delivered to their
platforms, and in fact the support for personal avatar display predates BIMI. Some
domain owners wishing to participate in BIMI may also desire to have personal avatars
displayed for some classes of mail sent using their domain. BIMI offers two options
for this - an optional <a href="#bimi-selector">BIMI-Selector header</a>, a local-part selector tag, or avatar preference tag in the
<a href="#assertion-record-definition">BIMI Assertion Record</a>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="assertion-record-definition">
<section id="section-4.3">
        <h3 id="name-assertion-record-definition">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-assertion-record-definition" class="section-name selfRef">Assertion Record Definition</a>
        </h3>
<p id="section-4.3-1">All Domain Owner BIMI preferences are expressed in DNS TXT records published
in subdomains named "_bimi".  Multiple sets of preferences can be associated
with a single RFC5322.From domain.  To distinguish between these different
preferences, BIMI defines and uses [selectors]{#selectors}. Senders declare
which selector to use for a given message by specifying the selector in an
optional <a href="#bimi-selector">BIMI-Selector header</a>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">For example, the Domain Owner of "example.com" would post BIMI policy in a
TXT record at "default.<em>bimi.example.com".  Similarly, a Mail Receiver wishing
to query for BIMI policy regarding mail with an RFC5322.From Author Domain of
"example.com" and a selector "default" (the default) would query the TXT record
located at the subdomain of "default.</em>bimi.example.com".  The DNS-based BIMI
policy record is referred to as the "BIMI Assertion Record" or "Assertion
Record".<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">BIMI Assertion Records follow the extensible "tag-value" syntax for DNS-based
key records as defined in DKIM <span>[<a href="#RFC6376" class="xref">RFC6376</a>]</span>.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Assertion Records are defined precisely. Mail receivers MUST NOT attempt to
fix syntactical or capitalization errors. If a required tag is missing, or
its value not well-formed, it is an error.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">This section creates a registry for known BIMI tags and registers the initial
set defined in this document.  Only tags defined in this document or in later
extensions, and thus added to the registry, are to be processed; unknown tags
MUST be ignored.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The following tags are introduced as the initial valid BIMI tags:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">v= Version (plain-text; REQUIRED).  Identifies the record retrieved as a BIMI
record.  It MUST have the value of "BIMI1" for implementations compliant with
this version of BIMI.  The value of this tag MUST match precisely; if it does
not match or it is absent, the entire retrieved record MUST be ignored.  It
MUST be the first tag in the list.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-8">
<pre>ABNF:

bimi-version = "v" *WSP "=" *WSP "BIMI1"
</pre><a href="#section-4.3-8" class="pilcrow">¶</a>
</div>
<p id="section-4.3-9">a= Authority Evidence Location (plain-text; URI; OPTIONAL).  If present, this
tag MUST have an empty value or its value MUST be a single URI.  An empty
value for the tag is interpreted to mean the Domain Owner does not wish to
publish or does not have authority evidence to disclose.  The URI, if present,
MUST contain a fully qualified domain name (FQDN) and MUST specify HTTPS as
the URI scheme ("https").  The URI SHOULD specify the location of a publicly
retrievable BIMI Evidence Document. The format for evidence documents is
defined in a separate document.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">If the a= tag is not present, it is assumed to have an empty value.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-11">
<pre>ABNF:

bimi-evidence-location = "a" *WSP "=" *WSP [bimi-uri]

bimi-uri = \[FWS\] URI \[FWS\]

; "URI" is imported from [URI]
; HTTPS only
; commas within a URI (ASCII ; 0x2C) MUST be encoded
</pre><a href="#section-4.3-11" class="pilcrow">¶</a>
</div>
<p id="section-4.3-12">l= location (URI; REQUIRED).  The value of this tag is either empty
indicating declination to publish, or a single URI representing the
location of a Brand Indicator file.  The only supported transport is HTTPS.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-13">
<pre>ABNF:

bimi-location = "l" *WSP "=" *WSP [bimi-uri]
</pre><a href="#section-4.3-13" class="pilcrow">¶</a>
</div>
<p id="section-4.3-14">lps= Local-Part as selector (plain-text "true" or false"; OPTIONAL; default is
"false"). If the value is "true", then the MBP MUST lookup a selector derived
from the local-part of the sending email address.<a href="#section-4.3-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-15">
<pre>ABNF:

local-part-selector = "lps" *WSP "=" *WSP %s "true"/"false" bimi-sep
</pre><a href="#section-4.3-15" class="pilcrow">¶</a>
</div>
<p id="section-4.3-16">avp= Avatar Preference (plain-text; OPTIONAL; default is "brand"). For mail sent
to those mailbox providers that both participate in BIMI and support the display
of personal avatars, this flag is a way for the Domain Owner to express its preference
as to whether to show the BIMI logo or the personal avatar. If the tag is not present
in an otherwise syntactically valid BIMI record, then the record is treated as if
it included "avp=brand". Allowed values are:<a href="#section-4.3-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-17">
<pre>personal: If BIMI is in place for the sending domain and the sender of the email
has a personal avatar, then the mailbox provider SHOULD display the personal avatar
for the message when shown in the recipient’s mailbox. If the sender has no personal
avatar, then the BIMI logo should be shown if the message qualifies for such display.

brand: If BIMI is in place for the sending domain and the sender of the email has a
personal avatar, then the mailbox provider SHOULD display the BIMI logo for the domain
if the message qualifies for such display.
</pre><a href="#section-4.3-17" class="pilcrow">¶</a>
</div>
<p id="section-4.3-18">Any other values MUST be ignored and not included in and added headers. A mailbox provider
MAY choose to treat an invalid preference value as a failing record.<a href="#section-4.3-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-19">
<pre>ABNF:

bimi-logo-preference = "avp" *WSP "=" *WSP %s "personal"/"brand" bimi-sep
</pre><a href="#section-4.3-19" class="pilcrow">¶</a>
</div>
<p id="section-4.3-20">Therefore, the formal definition of the BIMI Assertion Record, using ABNF <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>,
is as follows:<a href="#section-4.3-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-21">
<pre>bimi-sep = *WSP ";" *WSP

bimi-record = bimi-version (bimi-sep bimi-location) [(bimi-sep bimi-evidence-location)] [(local-part-selector)] [(bimi-sep bimi-logo-preference)] [bimi-sep]

; components other than bimi-version may appear in any order
</pre><a href="#section-4.3-21" class="pilcrow">¶</a>
</div>
<div id="declination-to-publish">
<section id="section-4.3.1">
          <h4 id="name-declination-to-publish">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-declination-to-publish" class="section-name selfRef">Declination to Publish</a>
          </h4>
<p id="section-4.3.1-1">If both the "l=" and "a=" tags are empty, it is an explicit refusal to
participate in BIMI. This is distinct from not publishing a BIMI record.
For example, an empty BIMI record enables a Domain Owner to decline BIMI
participation for a subdomain when its organizational domain has default
Indicators available. Furthermore, messages sent using a selector that
has declined to publish will not show an Indicator while messages with
other selectors would display normally.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">An explicit declination to publish looks like:<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-3">
<pre>v=BIMI1; l=; a=;
</pre><a href="#section-4.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-4">If the sender wishes to only enable BIMI on specific selectors utilizing
the local-part selector mechanism, but decline BIMI for the default case
then the BIMI record may look like:<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-5">
<pre>v=BIMI1; l=; a=; lps=true;
</pre><a href="#section-4.3.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="supported-image-formats-for-l-tag">
<section id="section-4.3.2">
          <h4 id="name-supported-image-formats-for">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-supported-image-formats-for" class="section-name selfRef">Supported Image Formats for l= tag</a>
          </h4>
<p id="section-4.3.2-1">Any format in the BIMI-formats IANA registry are acceptable targets for
the l= tag. If an l= tag URI ends with any other image format suffix, or
if the document retrievable from the location(s) in the l= tag are of any
other format, the evaluation of the record MUST be treated as a permanent
error.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">As of the publishing of this document, only SVG and SVGZ, as defined in
<a href="https://tools.ietf.org/html/rfc6170#section-5.2">RFC6170 section 5.2</a>
is acceptable in the l= tag.  Further restrictions apply to the SVG;
these are documented elsewhere.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="selectors">
<section id="section-4.4">
        <h3 id="name-selectors">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-selectors" class="section-name selfRef">Selectors</a>
        </h3>
<p id="section-4.4-1">To support publishing and display of more than one distinct Brand Indicator
per domain, the brand Indicator namespace is subdivided for publishing of
multiple Assertion Records using "selectors".  Selectors allow the Domain
Owner to choose the brand Indicator, for example, by type of recipient, by
message source, or by other considerations like seasonal branding.  BIMI
selectors are modeled after
<a href="https://tools.ietf.org/html/rfc6376#section-3.1">DKIM selectors</a>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The selector "default" is the default Assertion Record. Domain Owners can
specify which other selector to use on a per-message basis by utilizing
the <a href="#bimi-selector">BIMI-Selector Header</a>, or by utilizing
<a href="#local-part-delectors">Loca-lpart Selectors</a>.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Periods are allowed in selectors and are component separators.  When BIMI
Assertion Records are retrieved from the DNS, periods in selectors define
DNS label boundaries in a manner similar to the conventional use in domain
names.  In a DNS implementation, this can be used to allow delegation of a
portion of the selector namespace.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-4">
<pre>ABNF:

selector = sub-domain *( "." sub-domain )

; from [SMTP] Domain,

; excluding address-literal
</pre><a href="#section-4.4-4" class="pilcrow">¶</a>
</div>
<p id="section-4.4-5">The number of selectors for each domain is determined by the Domain Owner.
Many Domain Owners will be satisfied with just one selector, whereas
organizations with more complex branding requirements can choose to manage
disparate selectors.  BIMI sets no maximum limit on the number of selectors.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local-part-selectors">
<section id="section-4.5">
        <h3 id="name-local-part-selectors">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-local-part-selectors" class="section-name selfRef">Local-part Selectors</a>
        </h3>
<p id="section-4.5-1">To support the case where a domain owner may wish to display more than one
distinct Brand Indicator per domain, or decline to publish a Brand Indicator
for specific messages, but is unable to easily add BIMI-Selector headers to
the relevant outbound mail, the BIMI assertion record may include the tag
lps=true (local-part selector).<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">If this tag is present then a supporting MBP MUST perform the following actions.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">1 - Each time a BIMI assertion record is queried, either for the RFC5322 domain
     or for the Organizational domain thereof.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">2 - Lookup the BIMI assertion record and check for the lps=true tag, if this is
     not present then processing continues as normal.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">3 - Normalize the local-part of the sending email address using the following algorithm<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-6.1">
            <p id="section-4.5-6.1.1">Remove any Subaddress Extension (<span>[<a href="#RFC5233" class="xref">RFC5233</a>]</span>) part (sometimes called plus addressing)
from the local-part address.
If the local-part contains the plus character ("+", ASCII value 43) then remove
this character along with all following characters from the string.<a href="#section-4.5-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-6.2">
            <p id="section-4.5-6.2.1">Replace all underscores ("_", ASCII value 95) and periods
(".", ASCII value 46) with a dash ("-", ASCII value 45). If more
than 1 of these occur sequentially then replace the group with
a single dash. Dashes at the beginning and end of the string
are removed.<a href="#section-4.5-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-6.3">
            <p id="section-4.5-6.3.1">If the remaining local-part contains only letters ("A-Z", ASCII value 65-90)
("a-z", ASCII value 97-122), digits ("0-9", ASCII value 48-57), and dashes ("-", ASCII value 45, and is at most 63 characters long, then the string is in normalized form and
may be used as a selector.<a href="#section-4.5-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-6.4">
            <p id="section-4.5-6.4.1">If the remaining local-part contains any other characters then it may
not be used as a selector, There are several RFCs which discuss
potential solutions to this, including (<span>[<a href="#RFC3492" class="xref">RFC3492</a>]</span>), (<span>[<a href="#RFC7929" class="xref">RFC7929</a>]</span>)
and (<span>[<a href="#RFC6530" class="xref">RFC6530</a>]</span>), however to simplify the selector name and
resulting DNS record, it is recommended that only the above mentioned
characters be used in sending email addresses for BIMI local-part
selectors.<a href="#section-4.5-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-6.5">
            <p id="section-4.5-6.5.1">While the local-part may be considered case sensitive, the selector is case insensitive.
This must be taken into consideration when choosing the local-part for sending
BIMI selector enabled mail.<a href="#section-4.5-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.5-7">4 - Using the normalized local-part as a selector, lookup the BIMI assertion
     record from the domain at which the lps=true tag was found with the new
     local-part selector present.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">5 - If this record is found then processing MUST continue as if this was the
     record found at step 1<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<p id="section-4.5-9">6 - If this record is not found then processing MUST continue using the
     original record as discovered at step 1<a href="#section-4.5-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bimi-headers">
<section id="section-5">
      <h2 id="name-bimi-header-fields">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-bimi-header-fields" class="section-name selfRef">BIMI Header Fields</a>
      </h2>
<p id="section-5-1">Once BIMI policies are published in DNS via Assertion Records, Domain Owners
can provide additional guidance to Mail Receivers, and Mail Receivers to their
MUAs through the use of BIMI header fields.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">BIMI header fields are case insensitive. If a required tag is missing, it
is an error.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="bimi-selector">
<section id="section-5.1">
        <h3 id="name-bimi-selector-header">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-bimi-selector-header" class="section-name selfRef">BIMI-Selector Header</a>
        </h3>
<p id="section-5.1-1">BIMI DNS records are placed in &lt;selector&gt;.<em>bimi.&lt;domain&gt;, and by default
they are placed in default.</em>bimi.&lt;domain&gt;. That is, for example.com, the
default Assertion Record is located in the DNS at default._bimi.example.com.
However, a Domain Owner may override the use of the default selector and
specify the use of an alternative using the RFC5322-compliant header
'BIMI-Selector'. The BIMI-Selector header consists of key value pairs:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">v= Version (plain-text; REQUIRED). The version of BIMI. It MUST have the
value of "BIMI1" for implementations compliant with this version of BIMI.
The value of this tag MUST match precisely; if it does not or it is absent,
the entire retrieved record MUST be ignored.  It MUST be the first tag in
the list.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>ABNF:

bimi-header-version = "v" *WSP "=" *WSP "BIMI" 1DIGIT
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">s= Selector (plain-text; REQUIRED). The location of the BIMI DNS record,
when combined with the RFC5322.From domain.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-5">
<pre>ABNF:

bimi-selector = "s" *WSP "=" *WSP selector
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">And the formal definition of the BIMI Selector Header, using ABNF, is as follows:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-7">
<pre>bimi-selector-header = bimi-header-version bimi-sep bimi-selector \[bimi-sep\]
</pre><a href="#section-5.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bimi-location">
<section id="section-5.2">
        <h3 id="name-bimi-location-header">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-bimi-location-header" class="section-name selfRef">BIMI-Location Header</a>
        </h3>
<p id="section-5.2-1">BIMI-Location is the header a Mail Receiver inserts that tells the MUA where
to get the BIMI Indicator from.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The syntax of the header is as follows:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">v= Version (plain-text; REQUIRED). The version of BIMI. It MUST have the
value of "BIMI1" for implementations compliant with this version of BIMI.
The value of this tag MUST match precisely; if it does not or it is absent,
he entire header MUST be ignored.  It MUST be the first tag in the list.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>The ABNF for bimi-header-version is imported exactly from the
[BIMI Selector Header](#bimi-selector).
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2-5">l: location of the BIMI Indicator (URI; OPTIONAL if a
bimi-evidence-location-header-uri is specified, otherwise REQUIRED.). Inserted
by the MTA after performing the required checks and obtaining the applicable
domain's published Assertion Record.  The value of this tag is a URI representing
the location of the Brand Indicator file.  HTTPS is the only supported transport.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-6">
<pre>ABNF:

bimi-location-header-uri = "l" *WSP "=" bimi-uri
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2-7">a: location of the BIMI Evidence Document (URI; REQUIRED if the BIMI Evidence
Document was verified). Inserted by the MTA after performing the required checks
and obtaining the applicable domain's published Assertion Record.  The value of
this tag is a URI representing the location of the BIMI Evidence Document.
HTTPS is the only supported transport.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-8">
<pre>ABNF:

bimi-evidence-location-header-uri = "a" *WSP "=" bimi-uri
</pre><a href="#section-5.2-8" class="pilcrow">¶</a>
</div>
<p id="section-5.2-9">And the formal definition of the BIMI Location Header, using ABNF, is as
follows:<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-10">
<pre>bimi-location-header-location-only = bimi-location-header-uri

bimi-location-header-evidence-only = bimi-evidence-location-header-uri

bimi-location-header-both = bimi-location-header-uri bimi-evidence-location-header-uri

bimi-location-options = bimi-location-header-location-only / bimi-location-header-evidence-only / bimi-location-header-both

bimi-location-header = bimi-header-version bimi-sep bimi-location-options \[bimi-sep\]
</pre><a href="#section-5.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bimi-indicator">
<section id="section-5.3">
        <h3 id="name-bimi-indicator-header">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-bimi-indicator-header" class="section-name selfRef">BIMI-Indicator Header</a>
        </h3>
<p id="section-5.3-1">BIMI-Indicator is the header a Mail Receiver inserts to pass a verified
Indicator to the MUA.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The header contains the SVG of the Indicator encoded as base64, and is
inserted by the MTA after performing the required checks and obtaining the
applicable domain's published Assertion Record.  The contents of this tag
MUST match the SVG Indicator content retrieved from the URI specified in
the BIMI-Location header. If he Indicator was supplied as a gzipped SVGZ
file then the MTA MUST uncompress the file before base64 encoding.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-3">
<pre>base64string    =  ALPHADIGITPS *([FWS] ALPHADIGITPS)
                   [ [FWS] "=" [ [FWS] "=" ] ]
</pre><a href="#section-5.3-3" class="pilcrow">¶</a>
</div>
<p id="section-5.3-4">And the formal definition of the BIMI Indicator Header, using ABNF, is as follows:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-5">
<pre>bimi-indicator-header = base64string
</pre><a href="#section-5.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bimi-logo-preference">
<section id="section-5.4">
        <h3 id="name-bimi-logo-preference-header">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-bimi-logo-preference-header" class="section-name selfRef">BIMI-Logo-Preference Header</a>
        </h3>
<p id="section-5.4-1">BIMI-Logo-Preference is the header a Mail Receiver inserts to pass the Domain
Owner's preference for personal avatar display to the MUA.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The syntax of the header is as follows:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-3">
<pre>ABNF:

bimi-logo-preference-header = "avp" *WSP "=" *WSP %s "personal"/"brand" bimi-sep
</pre><a href="#section-5.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="header-signing">
<section id="section-5.5">
        <h3 id="name-header-signing">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-header-signing" class="section-name selfRef">Header Signing</a>
        </h3>
<p id="section-5.5-1">If present, the BIMI-Selector header SHOULD be included in the DMARC-aligned
DKIM signature used to confirm authenticity of the message.  If it is not
included in the DMARC-compliant DKIM signature, the header SHOULD be ignored.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">Receivers MAY choose to apply additional methods to validate the BIMI-Selector
header, for example by evaluating a trusted [ARC] chain. In this case the
Receiver MAY choose to treat the message as if the BIMI-Selector header was
signed.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">The BIMI-Location, BIMI-Indicator, and BIMI-Logo-Preference headers MUST NOT be
DKIM signed. These headers are untrusted by definition, and is only for use between
an MTA and its MUAs after DKIM has been validated by the MTA. Therefore, signing
these headers is meaningless, and any messages with them signed are either coming from
malicious or misconfigured third parties.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="header-removal">
<section id="section-5.6">
        <h3 id="name-header-removal">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-header-removal" class="section-name selfRef">Header Removal</a>
        </h3>
<p id="section-5.6-1">When a site is BIMI-aware, the receiving MTA MUST remove the MTA-produced
headers (BIMI-Location, BIMI-Indicator, BIMI-Logo-Preference) when those
headers originate from outside the current site.  For example, a multi-stage
platform will likely want to leave those in place.  However, when the message
arrives from another site with those headers available, they MUST be removed.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">When a site is not BIMI-aware, they SHOULD remove those headers.  If the
receiving site has no awareness of that evaluation, the headers should be
treated as suspect, and removed.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bimi-sender">
<section id="section-6">
      <h2 id="name-domain-owner-actions">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-domain-owner-actions" class="section-name selfRef">Domain Owner Actions</a>
      </h2>
<p id="section-6-1">This section includes a walk through of the actions a Domain Owner takes when
setting up Assertion Records and sending email messages.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="determine-and-publish-indicator-s-for-use">
<section id="section-6.1">
        <h3 id="name-determine-and-publish-indic">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-determine-and-publish-indic" class="section-name selfRef">Determine and Publish Indicator(s) for Use</a>
        </h3>
<p id="section-6.1-1">Domain Owners should consider which Indicator file formats to choose when
setting up their BIMI Assertion Records. For a Sender, BIMI provides control
over which Indicators are eligible and can be chosen for display, but not the
ultimate manner in which the MUA will display the Indicator.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="publish-assertion-records">
<section id="section-6.2">
        <h3 id="name-publish-assertion-records">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-publish-assertion-records" class="section-name selfRef">Publish Assertion Records</a>
        </h3>
<p id="section-6.2-1">For each set of Indicators and domains, publish the appropriate Assertion
Record as either "default" or a named selector as a DNS TXT record within
the appropriate "_bimi" namespace.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manage-multiple-uses-of-the-same-indicator-s-within-a-trust-boundary">
<section id="section-6.3">
        <h3 id="name-manage-multiple-uses-of-the">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-manage-multiple-uses-of-the" class="section-name selfRef">Manage multiple uses of the same Indicator(s) within a trust boundary</a>
        </h3>
<p id="section-6.3-1">For Domain Owners with multiple domains that wish to share the same set
of Indicators within a trust boundary and only manage those Indicators
from a single DNS location, it is RECOMMENDED to use DNS CNAMEs.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Using a CNAME here is functionally similar to the SPF redirect modifier.
Since BIMI does not require l= tags to be aligned to the Author Domain,
CNAMEs present a cleaner solution than extending the protocol.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="set-the-headers-on-outgoing-email-as-appropriate">
<section id="section-6.4">
        <h3 id="name-set-the-headers-on-outgoing">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-set-the-headers-on-outgoing" class="section-name selfRef">Set the headers on outgoing email as appropriate</a>
        </h3>
<p id="section-6.4-1">Once a default Assertion Record has been published for an Author Domain,
all emails from this domain should display the appropriate Indicator in
participating MUAs.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">If a non-default Indicator is desired, the BIMI-Selector header should be
set appropriately. If for some reason this selector cannot be accessed by
the Protocol Client, the fallback is the default Assertion Record on the
Organization domain.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">The BIMI-Location header MUST NOT be set by email senders, and Protocol
Clients MUST ignore it.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="receiver-actions">
<section id="section-7">
      <h2 id="name-receiver-actions">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-receiver-actions" class="section-name selfRef">Receiver Actions</a>
      </h2>
<p id="section-7-1">This section includes a walk through of the actions a Protocol Client
takes when evaluating an email message for BIMI Assertion.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="authentication-requirements">
<section id="section-7.1">
        <h3 id="name-authentication-requirements">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-authentication-requirements" class="section-name selfRef">Authentication Requirements</a>
        </h3>
<p id="section-7.1-1">Before applying BIMI processing for a message, a receiver MUST verify
that the message passed the following BIMI authentication requirements:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-2">
<li id="section-7.1-2.1">If more than 1 RFC5322.From header is present in the message, or any
RFC5322.From header contains more than 1 email address then BIMI
processing MUST NOT be performed for this message.<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.2">Start with the DNS domain found in the RFC5322.From header in the
message.  Define this DNS domain as the Author Domain.<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.3">Find the Organizational Domain for the Author Domain. Define this
DNS domain as the Author Organizational Domain. If the Author Domain
is an Organizational Domain then this will be identical to the Author
Domain.<a href="#section-7.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.4">Evaluate the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> result for the Author Domain.  Define
the result as the BIMI DMARC Result.<a href="#section-7.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.5">If the BIMI DMARC result is not 'pass', then the receiver MAY choose
to apply additional authentication methods, for example by evaluating
a trusted ARC <span>[<a href="#RFC8617" class="xref">RFC8617</a>]</span> chain, a list of trusted forwarders, or by applying a
local policy. In this case the Receiver MAY choose to treat the message
as if the BIMI DMARC Result was 'pass'.<a href="#section-7.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.6">If the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> result for the Author Domain is not 'pass', and the
message could not be authenticated by any additional authentication
method, then BIMI processing MUST NOT be performed for this message.<a href="#section-7.1-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.7">If the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> policy for the Author Domain or Author Organizational
Domain is p=none then BIMI processing MUST NOT be performed for this
message.<a href="#section-7.1-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.8">If the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> record for the Author Domain or Author Organizational
Domain includes a subdomain policy, and that subdomain policy is
sp=none then BIMI processing MUST NOT be performed for this message.<a href="#section-7.1-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-7.1-2.9">If the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> policy for the Author Domain or Author Organizational
Domain is p=quarantine, and the DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> record defines a percentage
tag, then that tag MUST be pct=100, otherwise BIMI processing MUST
NOT be performed for this message.<a href="#section-7.1-2.9" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="assertion-record-discovery">
<section id="section-7.2">
        <h3 id="name-assertion-record-discovery">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-assertion-record-discovery" class="section-name selfRef">Assertion Record Discovery</a>
        </h3>
<p id="section-7.2-1">Through the <a href="#assertion-record-definition">BIMI Assertion Record</a>, Domain
Owners use DNS TXT records to advertise their preferences.  Preference
discovery is accomplished via a method similar to the method used for
DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> records.  This method, and the important differences between
BIMI and DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span> mechanisms, are discussed below.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">Assertion Record Discovery MUST NOT be attempted if the message
authentication fails per Receiver policy.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">To balance the conflicting requirements of supporting wildcarding, allowing
subdomain policy overrides, and limiting DNS query load, Protocol Clients
MUST employ the following lookup scheme for the appropriate BIMI record
for the message:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-4">
<li id="section-7.2-4.1">Start with the DNS domain found in the RFC5322.From header in the message.
Define this DNS domain as the Author Domain.<a href="#section-7.2-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.2">If the message for which the Indicator is being determined specifies a
selector value in the <a href="#bimi-selector">BIMI Selector Header</a>, use this
value for the selector.  Otherwise the value 'default' MUST be used for
the selector.<a href="#section-7.2-4.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.3">Clients MUST query the DNS for a BIMI TXT record at the DNS domain constructed
by concatenating the selector, the string '_bimi', and the Author Domain.  A
possibly empty set of records is returned.<a href="#section-7.2-4.3" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.4">Records that do not start with a "v=" tag that identifies the current version
of BIMI MUST be discarded.<a href="#section-7.2-4.4" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.5">If the resulting record includes the <a href="#local-part-selectors">Local-part Selector</a>
tag lps=true then the client MUST first normalize the local-part of the
RFC5322.From header as detailed in <a href="#local-part-selectors">Local-part Selector</a>,
and if this differs from any selector and domain combination already queried,
MUST query DNS for the BIMI TXT record at the domain constructed by concatenating
the normalized selector, the string '_bimi', and the Author domain. If a valid
BIMI record is found then this should be used, if not then the BIMI record
retrieved in step 3 MUST be used instead.<a href="#section-7.2-4.5" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.6">If the set is now empty, the Client MUST query the DNS for a BIMI TXT record
at the DNS domain constructed by concatenating the selector, the string '<em>bimi',
and the Organizational Domain (as defined in DMARC <span>[<a href="#RFC7489" class="xref">RFC7489</a>]</span>) corresponding
to the Author Domain. A custom selector that does not exist falls back to
&lt;selector&gt;.</em>bimi.&lt;organizationalDomain&gt;.  A possibly empty set of records
is returned.<a href="#section-7.2-4.6" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.7">Records that do not start with a "v=" tag that identifies the current version
of BIMI MUST be discarded.<a href="#section-7.2-4.7" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.8">If the resulting record includes the <a href="#local-part-selectors">Local-part Selector</a>
tag lps=true then the client MUST first normalize the local-part of the
RFC5322.From header as detailed in <a href="#local-part-selectors">Local-part Selector</a>,
and if this differs from any selector and domain combination already queried,
MUST query DNS for the BIMI TXT record at the domain constructed by concatenating
the normalized selector, the string '_bimi', and the Organizational domain. If a valid
BIMI record is found then this should be used, if not then the BIMI record
retrieved in step 6 MUST be used instead.<a href="#section-7.2-4.8" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.9">If the remaining set contains multiple records or no records, Assertion Record
Discovery terminates and BIMI processing MUST NOT be performed for this message.<a href="#section-7.2-4.9" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-4.10">If the remaining set contains only a single record, this record is used for BIMI
Assertion.<a href="#section-7.2-4.10" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="indicator-discovery">
<section id="section-7.3">
        <h3 id="name-indicator-discovery">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-indicator-discovery" class="section-name selfRef">Indicator Discovery.</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-7.3-1">
<li id="section-7.3-1.1">If the retrieved Assertion Record does not include a valid bimi-location in
the l= tag, then Indicator Discovery has failed, and the Indicator MUST NOT
be displayed. The bimi-location entry MUST be a URI with a HTTPS transport.<a href="#section-7.3-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.3-1.2">If the retrieved Assertion Record includes a bimi-evidence-location entry in
the a= tag, and the receiver supports BIMI Evidence Document validation, then
proceed to the
<a href="#indicator-discovery-with-evidence">Indicator Discovery With Evidence</a> step.<a href="#section-7.3-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.3-1.3">If the receiver does not support BIMI Evidence Document validation, or the
retrieved Assertion Record does not include a bimi-evidence-location entry,
then proceed to the
<a href="#indicator-discovery-without-evidence">Indicator Discovery Without Evidence</a> step.<a href="#section-7.3-1.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="indicator-discovery-with-evidence">
<section id="section-7.4">
        <h3 id="name-indicator-discovery-with-ev">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-indicator-discovery-with-ev" class="section-name selfRef">Indicator Discovery With Evidence.</a>
        </h3>
<p id="section-7.4-1">Individual types of BIMI Evidence Document MAY specify extra discovery and
validation steps. These will be defined in separate documents.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="indicator-discovery-without-evidence">
<section id="section-7.5">
        <h3 id="name-indicator-discovery-without">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-indicator-discovery-without" class="section-name selfRef">Indicator Discovery Without Evidence.</a>
        </h3>
<p id="section-7.5-1">If an Assertion Record is found, and it has empty bimi-location and
bimi-evidence-location then this is a Declination to Publish record. BIMI processing
MUST not occur on this message and the MTA SHOULD reflect this in the
Authentication-Results header by adding a bimi=declined entry.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">If an Assertion Record is found, and has an empty or missing bimi-evidence-location
entry then no evidence has is presented, and the Indicator MUST be retrieved from
the URI specified in the bimi-location entry using the following algorithm:<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.5-3">
<li id="section-7.5-3.1">Retrieve the SVG Indicator from the URI specified in the l= tag. This MUST be
a URI with a HTTPS transport.<a href="#section-7.5-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.5-3.2">If the TLS server identity certificate presented during the TLS session setup
does not chain-up to a root certificate the Client trusts then Indicator validation
has failed and the Indicator MUST NOT be displayed.<a href="#section-7.5-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.5-3.3">Proceed to the <a href="#indicator-validation">Indicator Validation</a> step.<a href="#section-7.5-3.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="indicator-validation">
<section id="section-7.6">
        <h3 id="name-indicator-validation">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-indicator-validation" class="section-name selfRef">Indicator Validation</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-7.6-1">
<li id="section-7.6-1.1">Check the file size of the retrieved Indicator against recommended maximum sizes
as defined in this document, and in the BIMI SVG document. A receiver MAY choose
to implement their own file size restrictions. If the Indicator is larger than
the maximum size the the receiver MAY choose not to display the Indicator. A
receiver MAY choose to implement the size limit as a retrieval limit rather than
retrieving the entire document and then checking the size.<a href="#section-7.6-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.6-1.2">If the SVG Indicator is missing, or is not a valid SVG or SVGZ document then
validation has failed and the Indicator MUST NOT be displayed.<a href="#section-7.6-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.6-1.3">Check the retrieved Indicator against the SVG validation steps specified in this
document, and in the BIMI SVG document.<a href="#section-7.6-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-7.6-1.4">If Indicator verification has passed, and the Indicator is from a trusted source,
then the Indicator MAY be displayed per receiver policy.<a href="#section-7.6-1.4" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="bimi-results">
<section id="section-7.7">
        <h3 id="name-affix-bimi-status-to-authen">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-affix-bimi-status-to-authen" class="section-name selfRef">Affix BIMI Status to Authentication Results Header Field</a>
        </h3>
<p id="section-7.7-1">Upon completion of Assertion Record Discovery, Indicator Discovery, and
Indicator Validation, an MTA SHOULD affix the result in the Authentication-Results
header using the following syntax, with the following key=value pairs:<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">bimi: Result of the bimi lookup (plain-text; REQUIRED). Range of values are
'pass' (BIMI successfully validated), 'none' (no BIMI record present),
'fail' (syntax error in the BIMI record, failure in Discovery or Validation
steps, or some other error), 'temperror' (DNS lookup problem), 'declined'
(The domain owner published an explicit declination record), or 'skipped'
(BIMI check was not performed, possibly because the message did not comply
with the minimum requirements such as passing DMARC, or the MTA does not
trust the sending domain). The MTA MAY put comments in parentheses after
bimi result, e.g., "bimi=fail (Invalid SVG)", "bimi=skipped (sender not
trusted)" or "bimi=skipped (message failed DMARC)".<a href="#section-7.7-2" class="pilcrow">¶</a></p>
<p id="section-7.7-3">header.d: Domain of the BIMI Assertion Record which was evaluated (plain-text;
REQUIRED if bimi=pass). For example, this will be the organizational domain
if the BIMI lookup used the fallback record, otherwise it will be the RFC5322.From domain.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
<p id="section-7.7-4">header.selector: Selector of the BIMI Assertion Record which was evaluated
(plain-text; REQUIRED if bimi=pass). For example, if a BIMI-Selector Header
was present and used to discover a BIMI Assertion Record then this will be
the Selector used, otherwise this will be 'default'.<a href="#section-7.7-4" class="pilcrow">¶</a></p>
<p id="section-7.7-5">policy.authority: Authority verification status of the Brand Identifier
(plain-text; REQUIRED if the BIMI Evidence Document was checked). If the
Authority Evidence presented in the BIMI Assertion Record was checked and
found to be valid then this MUST be set to pass. If the validation failed
then this MUST be set to fail. If no Authority Evidence was presented, or
the MTA did not check the Authority Evidence then this SHOULD be set to none.<a href="#section-7.7-5" class="pilcrow">¶</a></p>
<p id="section-7.7-6">policy.authority-uri: The URI of the BIMI Evidence Document checked, as found
in the a= tag of the BIMI Assertion Record (plain-text; OPTIONAL).<a href="#section-7.7-6" class="pilcrow">¶</a></p>
<p id="section-7.7-7">policy.indicator-uri: The URI of the BIMI Indicator, as found in the l= tag
of the BIMI Assertion Record (plain-text; OPTIONAL).<a href="#section-7.7-7" class="pilcrow">¶</a></p>
<p id="section-7.7-8">policy.indicator-hash: In order to prevent MUAs from displaying indicators from
the BIMI-Indicator header which have been modified since delivery, the MTA MAY
add a hash of the data referenced in that header into the Authentication-Results
entry such that the hash can be signed by, and verified by an ARC aware MTA/MUA pair.
The raw uncompressed data of the SVG Indicator is hashed with SHA-256, the resulting
hash is truncated to the final 8 (at least) characters, and added to the Authentication-Results
entry.
If this entry is added then the MTA MUST also add the BIMI-Indicator header.<a href="#section-7.7-8" class="pilcrow">¶</a></p>
<p id="section-7.7-9">policy.logo-preference: Contains the Domain Owner's preference for personal avatar display
as defined in the BIMI-Logo-Preference header (plain-text; OPTIONAL).
The MTA MUST NOT add this entry if the value discovered in the BIMI record was invalid.<a href="#section-7.7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handle-existing-bimi-location-and-bimi-indicator-headers">
<section id="section-7.8">
        <h3 id="name-handle-existing-bimi-locati">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-handle-existing-bimi-locati" class="section-name selfRef">Handle Existing BIMI-Location and BIMI-Indicator Headers</a>
        </h3>
<p id="section-7.8-1">Regardless of success of the BIMI lookup, if a BIMI-Location, BIMI-Indicator,
or BIMI-Logo-Preference header is already present in a message it MUST be either
removed or renamed.
This is because the MTA performing BIMI-related processing immediately prior
to a Mail Delivery Agent (or within the same administrative realm) is the only
entity allowed to specify the BIMI-Location, BIMI-Indicator, and BIMI-Logo-Preference
headers (e.g. not the sending MTA, and not an intermediate MTA).  Allowing one or more
existing headers through to a MUA is a security risk.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<p id="section-7.8-2">If the original email message had a DKIM signature, it has already been evaluated.
Removing the BIMI-Location, BIMI-Indicator, or BIMI-Logo-Preference headers at this
point should not invalidate the signature since it should not be included within it
per this spec.<a href="#section-7.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="construct-bimi-location-uri">
<section id="section-7.9">
        <h3 id="name-construct-bimi-location-uri">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-construct-bimi-location-uri" class="section-name selfRef">Construct BIMI-Location URI</a>
        </h3>
<p id="section-7.9-1">This header MUST NOT be added if Discovery or Validation steps failed.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
<p id="section-7.9-2">The URI used to retrieve the validated SVG Indicator. If the receiver extracted
the Indicator from the BIMI Evidence Document then this SHOULD be the
bimi-evidence-location added with a a= tag, otherwise it SHOULD be the
bimi-location added with a l= tag. If both a= and l= tags are included then the
MTA MUST perform checks to ensure that the SVG Indicator referenced by the
bimi-location is identical to the SVG Indicator extracted from the BIMI Evidence
Document.<a href="#section-7.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="construct-bimi-indicator-header">
<section id="section-7.10">
        <h3 id="name-construct-bimi-indicator-he">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-construct-bimi-indicator-he" class="section-name selfRef">Construct BIMI-Indicator header</a>
        </h3>
<p id="section-7.10-1">This header MUST NOT be added if Discovery or Validation steps failed.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">Encode the SVG Indicator retrieved and validated during the Indicator
Discovery and Indicator Validation steps as base64 encoded data. If the
Indicator was compressed with gzip when retrieved then the data MUST be
uncompressed before being base64 encoded.<a href="#section-7.10-2" class="pilcrow">¶</a></p>
<p id="section-7.10-3">The MTA MUST fold the header to be within the line length limits of SMTP <span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span>.<a href="#section-7.10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="construct-bimi-logo-preference-header">
<section id="section-7.11">
        <h3 id="name-construct-bimi-logo-prefere">
<a href="#section-7.11" class="section-number selfRef">7.11. </a><a href="#name-construct-bimi-logo-prefere" class="section-name selfRef">Construct BIMI-Logo-Preference header</a>
        </h3>
<p id="section-7.11-1">This header MUST NOT be added if Discovery or Validation steps failed.<a href="#section-7.11-1" class="pilcrow">¶</a></p>
<p id="section-7.11-2">This contains the policy from the BIMI record indicating the domain owners preference
for logo display.<a href="#section-7.11-2" class="pilcrow">¶</a></p>
<p id="section-7.11-3">The MTA MUST fold the header to be within the line length limits of SMTP <span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span>.<a href="#section-7.11-3" class="pilcrow">¶</a></p>
<p id="section-7.11-4">The MTA MUST NOT add this header if the value discovered in the BIMI record was invalid.<a href="#section-7.11-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">The consistent use of Brand Indicators is valuable for Domain Owners, Mail
Receivers, and End Users. However, the routine display of brand Indicators
represents an attractive target for abuse, especially for determined malicious
actors.  Great care is warranted.  The discussion following as an incomplete
list of considerations.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="indirect-mail-flows">
<section id="section-8.1">
        <h3 id="name-indirect-mail-flows">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-indirect-mail-flows" class="section-name selfRef">Indirect Mail Flows</a>
        </h3>
<p id="section-8.1-1">If a mail store ingests a message from another mail store through some other
means, the message may or may not have BIMI headers added already.  If the
receiving store trusts the other mail store, it may simply use existing headers.
Or, it may re-evaluate BIMI policy and requirements, and create or replace the
BIMI-Location header.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lookalike-domains-and-copycat-indicators">
<section id="section-8.2">
        <h3 id="name-lookalike-domains-and-copyc">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-lookalike-domains-and-copyc" class="section-name selfRef">Lookalike Domains and Copycat Indicators</a>
        </h3>
<p id="section-8.2-1">Publishing BIMI records is not sufficient for an MTA to signal to the MUA to
load the BIMI Indicator.  For example, the Domain Owner may also need to have
a sufficiently strong reputation with the MTA.  The receiver may use a manually
maintained list of large brands, it may import a list from a third party of
acceptable domains, or it may apply its own reputation heuristics before deciding
whether or not to load the BIMI Indicator.  BIMI does not specify what MTAs may
bring to bear as additional factors.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="large-files-and-buffer-overflows">
<section id="section-8.3">
        <h3 id="name-large-files-and-buffer-over">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-large-files-and-buffer-over" class="section-name selfRef">Large files and buffer overflows</a>
        </h3>
<p id="section-8.3-1">The MTA or MUA should perform some basic analysis and avoid loading Indicators
that are too large or too small.  The Receiver may choose to maintain a manual
list and do the inspection of its list offline so it doesn't have to do it at
time-of-scan.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="slow-dns-queries">
<section id="section-8.4">
        <h3 id="name-slow-dns-queries">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-slow-dns-queries" class="section-name selfRef">Slow DNS queries</a>
        </h3>
<p id="section-8.4-1">All email Receivers already have to query for DNS records, and all of them have
built-in timeouts when performing DNS queries.  Furthermore, the use of caching
when loading Indicators can help cut down on load time.  Virtually all email
clients have some sort of image-downloading built-in and make decisions when to
load or not load Indicators.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unaligned-indicators-and-asserting-domains">
<section id="section-8.5">
        <h3 id="name-unaligned-indicators-and-as">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-unaligned-indicators-and-as" class="section-name selfRef">Unaligned Indicators and asserting domains</a>
        </h3>
<p id="section-8.5-1">There is no guarantee that a group responsible for managing Brand Indicators will
have access to put these Indicators directly in any specific location of a domain,
and requiring that Indicators live on the asserted domain is too high a bar.
Additionally, letting a brand have Indicator locations outside its domain may be
desirable so that someone sending legitimate authenticated email on the Domain
Owner's behalf can manage and set selectors as an authorized third party without
requiring access to the Domain Owner's DNS or web services.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unsigned-bimi-selector-header">
<section id="section-8.6">
        <h3 id="name-unsigned-bimi-selector-head">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-unsigned-bimi-selector-head" class="section-name selfRef">Unsigned BIMI-Selector Header</a>
        </h3>
<p id="section-8.6-1">If a Domain Owner relies on SPF but not DKIM for email authentication, then adding
a requirement of DKIM may create too high of a bar for that sender.  On the other
hand, Receivers doing BIMI assertion may factor in the lack of DKIM signing when
deciding whether to add a BIMI-Location header.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cgi-scripts-in-indicator-payload">
<section id="section-8.7">
        <h3 id="name-cgi-scripts-in-indicator-pa">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-cgi-scripts-in-indicator-pa" class="section-name selfRef">CGI scripts in Indicator payload</a>
        </h3>
<p id="section-8.7-1">MTAs and MVAs should aggressively police Indicators to ensure they are the Indicators
they claim to be, are within appropriate size limits, and pass other sanity checks.
Additionally, MTAs might cache good Indicators and serve them directly to their MUAs,
which would in practice bypass any malicious dynamic payload set to trigger against
an end user but not an MTA.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata-in-indicators">
<section id="section-8.8">
        <h3 id="name-metadata-in-indicators">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-metadata-in-indicators" class="section-name selfRef">Metadata in Indicators</a>
        </h3>
<p id="section-8.8-1">Domain Owners should be careful to strip any metadata out of published Indicators
that they don't want to expose or which might bloat file size. MTAs and MVAs might
wish to inspect and remove such data from Indicators before exposing them to end
users.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">IANA will need to reserve three new entries for the "Permanent Message Header
Field Names" registry and create a registry for support file formats for BIMI.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="permanent-header-field-updates">
<section id="section-9.1">
        <h3 id="name-permanent-header-field-upda">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-permanent-header-field-upda" class="section-name selfRef">Permanent Header Field Updates</a>
        </h3>
<p id="section-9.1-1">Header field name: BIMI-Selector<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Applicable protocol: mail<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">Status: standard<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">Author/Change controller: IETF<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">Specification document: This one<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">Header field name: BIMI-Location<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<p id="section-9.1-7">Applicable protocol: mail<a href="#section-9.1-7" class="pilcrow">¶</a></p>
<p id="section-9.1-8">Status: standard<a href="#section-9.1-8" class="pilcrow">¶</a></p>
<p id="section-9.1-9">Author/Change controller: IETF<a href="#section-9.1-9" class="pilcrow">¶</a></p>
<p id="section-9.1-10">Specification document: This one<a href="#section-9.1-10" class="pilcrow">¶</a></p>
<p id="section-9.1-11">Header field name: BIMI-Indicator<a href="#section-9.1-11" class="pilcrow">¶</a></p>
<p id="section-9.1-12">Applicable protocol: mail<a href="#section-9.1-12" class="pilcrow">¶</a></p>
<p id="section-9.1-13">Status: standard<a href="#section-9.1-13" class="pilcrow">¶</a></p>
<p id="section-9.1-14">Author/Change controller: IETF<a href="#section-9.1-14" class="pilcrow">¶</a></p>
<p id="section-9.1-15">Specification document: This one<a href="#section-9.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="registry-for-supported-bimi-formats">
<section id="section-9.2">
        <h3 id="name-registry-for-supported-bimi">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-registry-for-supported-bimi" class="section-name selfRef">Registry for Supported BIMI Formats</a>
        </h3>
<p id="section-9.2-1">Names of support file types supported by BIMI must be registered by IANA.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">New entries are assigned only for values that have been documented in a
published RFC that has had IETF Review, per [IANA-CONSIDERATIONS]. Each
method must register a name, the file extension, the specification that
defines it, and a description.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-iana-needs">
<section id="section-9.3">
        <h3 id="name-other-iana-needs">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-other-iana-needs" class="section-name selfRef">Other IANA needs</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="under-discussion">
<section id="section-10">
      <h2 id="name-under-discussion">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-under-discussion" class="section-name selfRef">Under Discussion</a>
      </h2>
<p id="section-10-1">NOTE: Items currently being discussed<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">o Can the MUA validate BIMI directly? What hints are needed? How can it be validated with
some semblance of trust?<a href="#section-10-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC1035">[RFC1035]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3492">[RFC3492]</dt>
      <dd>
<span class="refAuthor">Costello, A.</span>, <span class="refTitle">"Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)"</span>, <span class="seriesInfo">RFC 3492</span>, <span class="seriesInfo">DOI 10.17487/RFC3492</span>, <time datetime="2003-03" class="refDate">March 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3492">https://www.rfc-editor.org/info/rfc3492</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5233">[RFC5233]</dt>
      <dd>
<span class="refAuthor">Murchison, K.</span>, <span class="refTitle">"Sieve Email Filtering: Subaddress Extension"</span>, <span class="seriesInfo">RFC 5233</span>, <span class="seriesInfo">DOI 10.17487/RFC5233</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5233">https://www.rfc-editor.org/info/rfc5233</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
      <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5598">[RFC5598]</dt>
      <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Internet Mail Architecture"</span>, <span class="seriesInfo">RFC 5598</span>, <span class="seriesInfo">DOI 10.17487/RFC5598</span>, <time datetime="2009-07" class="refDate">July 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5598">https://www.rfc-editor.org/info/rfc5598</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6376">[RFC6376]</dt>
      <dd>
<span class="refAuthor">Crocker, D., Ed.</span>, <span class="refAuthor">Hansen, T., Ed.</span>, and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Signatures"</span>, <span class="seriesInfo">STD 76</span>, <span class="seriesInfo">RFC 6376</span>, <span class="seriesInfo">DOI 10.17487/RFC6376</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6530">[RFC6530]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span> and <span class="refAuthor">Y. Ko</span>, <span class="refTitle">"Overview and Framework for Internationalized Email"</span>, <span class="seriesInfo">RFC 6530</span>, <span class="seriesInfo">DOI 10.17487/RFC6530</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6530">https://www.rfc-editor.org/info/rfc6530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
      <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="seriesInfo">RFC 7208</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7489">[RFC7489]</dt>
      <dd>
<span class="refAuthor">Kucherawy, M., Ed.</span> and <span class="refAuthor">E. Zwicky, Ed.</span>, <span class="refTitle">"Domain-based Message Authentication, Reporting, and Conformance (DMARC)"</span>, <span class="seriesInfo">RFC 7489</span>, <span class="seriesInfo">DOI 10.17487/RFC7489</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7489">https://www.rfc-editor.org/info/rfc7489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7929">[RFC7929]</dt>
      <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refTitle">"DNS-Based Authentication of Named Entities (DANE) Bindings for OpenPGP"</span>, <span class="seriesInfo">RFC 7929</span>, <span class="seriesInfo">DOI 10.17487/RFC7929</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7929">https://www.rfc-editor.org/info/rfc7929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8617">[RFC8617]</dt>
    <dd>
<span class="refAuthor">Andersen, K.</span>, <span class="refAuthor">Long, B., Ed.</span>, <span class="refAuthor">Blank, S., Ed.</span>, and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"The Authenticated Received Chain (ARC) Protocol"</span>, <span class="seriesInfo">RFC 8617</span>, <span class="seriesInfo">DOI 10.17487/RFC8617</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8617">https://www.rfc-editor.org/info/rfc8617</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="BIMI-OVERVIEW">[BIMI-OVERVIEW]</dt>
      <dd>
<span class="refTitle">"An Overview of the Design of BIMI"</span>, <span>&lt;<a href="http://tools.ietf.org/html/draft-bkl-bimi-overview-00.html">http://tools.ietf.org/html/draft-bkl-bimi-overview-00.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="bimi-header-examples">
<section id="appendix-A">
      <h2 id="name-example-selector-discovery-">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-selector-discovery-" class="section-name selfRef">Example Selector Discovery (INFORMATIVE)</a>
      </h2>
<p id="appendix-A-1">This section shows several examples of how a receiving MTA should determine
which Assertion Record to use depending on the BIMI-Selector header.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="no-bimi-selector-header">
<section id="appendix-A.1">
        <h3 id="name-no-bimi-selector-header">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-no-bimi-selector-header" class="section-name selfRef">No BIMI-Selector Header</a>
        </h3>
<p id="appendix-A.1-1">The domain example.com does not send with a BIMI-Selector header.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>From: sender@example.com
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">The MTA would lookup default._bimi.example.com for the BIMI DNS record.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="with-bimi-selector-header">
<section id="appendix-A.2">
        <h3 id="name-with-bimi-selector-header">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-with-bimi-selector-header" class="section-name selfRef">With BIMI-Selector Header</a>
        </h3>
<p id="appendix-A.2-1">The domain example.com sends with a BIMI-Selector header:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>From: sender@example.com
BIMI-Selector: v=BIMI1; s=selector;
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-3">The MTA would lookup selector._bimi.example.com.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="without-bimi-selector-header-on-a-subdomain">
<section id="appendix-A.3">
        <h3 id="name-without-bimi-selector-heade">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-without-bimi-selector-heade" class="section-name selfRef">Without BIMI-Selector Header on a subdomain</a>
        </h3>
<p id="appendix-A.3-1">The domain foo.example.com sends without a BIMI-Selector header:<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3-2">
<pre>From: sender@foo.example.com
</pre><a href="#appendix-A.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3-3">The MTA would lookup default.<em>bimi.foo.example.com for the BIMI DNS record.
If it did not exist, it would lookup default.</em>bimi.example.com.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="with-bimi-selector-header-on-a-subdomain">
<section id="appendix-A.4">
        <h3 id="name-with-bimi-selector-header-o">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-with-bimi-selector-header-o" class="section-name selfRef">With BIMI-Selector Header on a subdomain</a>
        </h3>
<p id="appendix-A.4-1">The domain foo.example.com sends without a BIMI-Selector header:<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4-2">
<pre>From: sender@foo.example.com
BIMI-Selector: v=BIMI1; s=myselector;
</pre><a href="#appendix-A.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4-3">The MTA would lookup myselector.<em>bimi.foo.example.com for the BIMI DNS record.
If it did not exist, it would fall back to the lookup myselector.</em>bimi.example.com.<a href="#appendix-A.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-bimi-selector-header">
<section id="appendix-A.5">
        <h3 id="name-invalid-bimi-selector-heade">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-invalid-bimi-selector-heade" class="section-name selfRef">Invalid BIMI-Selector Header</a>
        </h3>
<p id="appendix-A.5-1">The domain example.com sends with a BIMI-Selector header, but does not include
the required field 'v=':<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.5-2">
<pre>From: sender@example.com
BIMI-Selector: s=myselector;
</pre><a href="#appendix-A.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.5-3">The MTA would ignore this header, and lookup default._bimi.example.com.<a href="#appendix-A.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ar-examples">
<section id="appendix-B">
      <h2 id="name-example-authentication-resu">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-example-authentication-resu" class="section-name selfRef">Example Authentication-Results entry (INFORMATIONAL)</a>
      </h2>
<p id="appendix-B-1">This section shows example Authentication-Results stamps based on different
BIMI lookup statuses.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="successful-bimi-lookup">
<section id="appendix-B.1">
        <h3 id="name-successful-bimi-lookup">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-successful-bimi-lookup" class="section-name selfRef">Successful BIMI lookup</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.1-1">
<pre>From: sender@example.com
BIMI-Selector: v=BIMI1; s=myselector;
Authentication-Results: example.com; bimi=pass header.d=example.com header.selector=myselector
</pre><a href="#appendix-B.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="no-bimi-record">
<section id="appendix-B.2">
        <h3 id="name-no-bimi-record">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-no-bimi-record" class="section-name selfRef">No BIMI record</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.2-1">
<pre>From: sender@sub.example.com
Authentication-Results: example.com; bimi=none
</pre><a href="#appendix-B.2-1" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-2">In this example, sub.example.com does not have a BIMI record at
default.<em>bimi.sub.example.com, nor does default.</em>bimi.example.com<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="declination-to-publish-1">
<section id="appendix-B.3">
        <h3 id="name-declination-to-publish-2">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-declination-to-publish-2" class="section-name selfRef">Declination to Publish</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.3-1">
<pre>From: sender@example.com
Authentication-Results: example.com; bimi=declined
</pre><a href="#appendix-B.3-1" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-2">In this example the record found at default._bimi.example.com was
"v=BIMI1; l=; a=;", indicating a Declination to Publish a BIMI Assertion
Record, and so indicating that BIMI processing should not occur on this message.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subdomain-has-no-default-record-but-organizational-domain-does">
<section id="appendix-B.4">
        <h3 id="name-subdomain-has-no-default-re">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-subdomain-has-no-default-re" class="section-name selfRef">Subdomain has no default record, but organizational domain does</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.4-1">
<pre>From: sender@sub.example.com
Authentication-Results: example.com; bimi=pass header.d=example.com header.selector=default
</pre><a href="#appendix-B.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="subdomain-and-organizational-domain-have-no-record-for-selector-but-organization">
<section id="appendix-B.5">
        <h3 id="name-subdomain-and-organizationa">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-subdomain-and-organizationa" class="section-name selfRef">Subdomain and organizational domain have no record for selector, but organization</a>
        </h3>
<p id="appendix-B.5-1">domain has a default<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.5-2">
<pre>From: sender@sub.example.com
BIMI-Selector: v=BIMI1; s=myselector;
Authentication-Results: example.com; bimi=none
</pre><a href="#appendix-B.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.5-3">In this example, the sender specified a DNS record at
myselector.<em>bimi.sub.example.com but it did not exist. The fallback is to
use myselector.</em>bimi.example.com, which also does not exist. The assertion
record does exist for the default selector at the organizational domain
default._bimi.example.com, however this is not used as the sender specified
a selector of myselector.<a href="#appendix-B.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subdomain-has-no-record-for-selector-but-organization-domain-does">
<section id="appendix-B.6">
        <h3 id="name-subdomain-has-no-record-for">
<a href="#appendix-B.6" class="section-number selfRef">B.6. </a><a href="#name-subdomain-has-no-record-for" class="section-name selfRef">Subdomain has no record for selector, but organization domain does</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-B.6-1">
<pre>From: sender@sub.example.com
BIMI-Selector: v=BIMI1; s=myselector;
Authentication-Results: example.com; bimi=pass header.d=example.com header.selector=myselector
</pre><a href="#appendix-B.6-1" class="pilcrow">¶</a>
</div>
<p id="appendix-B.6-2">In this example, the sender specified a DNS record at myselector.<em>bimi.sub.example.com
but it did not exist. The fallback is to use myselector.</em>bimi.example.com.<a href="#appendix-B.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bimi-headers-example">
<section id="appendix-C">
      <h2 id="name-example-bimi-headers-constr">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-example-bimi-headers-constr" class="section-name selfRef">Example BIMI Headers Construction (INFORMATIONAL)</a>
      </h2>
<p id="appendix-C-1">This section shows how an example MTA might evaluate an incoming email for BIMI
participation, and how it could share that determination with its MUA(s).<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="mta-receives-an-email">
<section id="appendix-C.1">
        <h3 id="name-mta-receives-an-email">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-mta-receives-an-email" class="section-name selfRef">MTA Receives an email</a>
        </h3>
<p id="appendix-C.1-1">The MTA receives the following DKIM signed message:<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-2">
<pre>DKIM-Signature: v=1; s=myExample; d=example.com; h=From;BIMI-Selector;Date;bh=...;b=...
From: sender@example.com
BIMI-Selector: v=BIMI1; s=brand;
BIMI-Location: image.example.com/bimi/logo/example-bimi.svg
Subject: Hi, this is a message from the good folks at Example Learning
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="mta-does-its-authentication-checks">
<section id="appendix-C.2">
        <h3 id="name-mta-does-its-authentication">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-mta-does-its-authentication" class="section-name selfRef">MTA does its authentication checks</a>
        </h3>
<p id="appendix-C.2-1">The receiving MTA receives the message and performs an SPF verification (which
fails), a DKIM verification (which passes), and a DMARC verification (which passes).
The domain is verified and has good reputation. The Receiver proceeds to perform a
BIMI lookup.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mta-performs-bimi-assertion">
<section id="appendix-C.3">
        <h3 id="name-mta-performs-bimi-assertion">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-mta-performs-bimi-assertion" class="section-name selfRef">MTA performs BIMI Assertion</a>
        </h3>
<p id="appendix-C.3-1">The MTA sees that the message has a BIMI-Selector header, and it is covered by
the DKIM-Signature, and the DKIM-Signature that passed DKIM is the one that covers
the BIMI-Selector header. The MTA sees the header validates and contains 'v=BIMI1',
and 's=brand'. It performs a DNS query for brand._bimi.example.com and retrieves:<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-2">
<pre>brand._bimi.example.com IN TXT "v=BIMI1; l=https://image.example.com/bimi/logo/"
</pre><a href="#appendix-C.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.3-3">The MTA verifies the syntax of the BIMI DNS record, and it, too passes.<a href="#appendix-C.3-3" class="pilcrow">¶</a></p>
<p id="appendix-C.3-4">The MTA knows it has previously retrieved the Indicator referenced by the BIMI DNS
record, and had already successfully checked this Indicator against the published
SVG profile. The MTA retrieves the Indicator from the cache.<a href="#appendix-C.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mta-appends-to-authentication-results">
<section id="appendix-C.4">
        <h3 id="name-mta-appends-to-authenticati">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-mta-appends-to-authenticati" class="section-name selfRef">MTA appends to Authentication-Results</a>
        </h3>
<p id="appendix-C.4-1">The MTA computes and affixes the results of the BIMI to the Authentication-Results
header:<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-2">
<pre>Authentication-Results: example.com; spf=fail smtp.mailfrom=example.com;
  dkim=pass (signature was verified) header.d=example.com;
  dmarc=pass header.from=example.com;
  bimi=pass header.d=example.com header.selector=brand
</pre><a href="#appendix-C.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="mta-constructs-bimi-location-and-bimi-indicator-headers">
<section id="appendix-C.5">
        <h3 id="name-mta-constructs-bimi-locatio">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-mta-constructs-bimi-locatio" class="section-name selfRef">MTA Constructs BIMI-Location and BIMI-Indicator headers</a>
        </h3>
<p id="appendix-C.5-1">The MTA base64 encodes the retrieved Indicator and constructs a new BIMI-Indicator
header.<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<p id="appendix-C.5-2">The MTA constructs a BIMI-Location header with a version tag, and an l tag indicating
the URL from which the Indicator was retrieved.<a href="#appendix-C.5-2" class="pilcrow">¶</a></p>
<p id="appendix-C.5-3">Finally, the MTA removes any existing BIMI-Location and BIMI-Indicator headers, and
stamps the new ones:<a href="#appendix-C.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5-4">
<pre>BIMI-Location: v=BIMI1; l=https://image.example.com/bimi/logo/

BIMI-Indicator: PD94bW...8L3N2Zz4K
</pre><a href="#appendix-C.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5-5">That the original sender signed a BIMI-Location header against this spec is irrelevant.
It was used for DKIM validation and then thrown out by the MTA.<a href="#appendix-C.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-mua-displays-the-indicator">
<section id="appendix-C.6">
        <h3 id="name-the-mua-displays-the-indica">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-the-mua-displays-the-indica" class="section-name selfRef">The MUA displays the Indicator</a>
        </h3>
<p id="appendix-C.6-1">The mail is opened from the mail store in an MUA. The MUA performs locally defined checks to
make sure that it can trust the BIMI-Indicator header. Finally, the MUA extracts the Indicator
from the BIMI-Indicator header and displays it to the user.<a href="#appendix-C.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">Many people have contributed to the development of BIMI.  Along with thanks to members of
the current AuthIndicators Working Group, the editors wish to acknowledge the efforts of
Sri Somanchi, Don Cardinal, Steve Jones, and John Levine.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Seth Blank</span></div>
<div dir="auto" class="left"><span class="org">Valimail</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:seth@valimail.com" class="email">seth@valimail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter Goldstein</span></div>
<div dir="auto" class="left"><span class="org">Valimail</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:peter@valimail.com" class="email">peter@valimail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thede Loder</span></div>
<div dir="auto" class="left"><span class="org">Skye Logicworks LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thede@skyelogicworks.com" class="email">thede@skyelogicworks.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Terry Zink</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tzink@terryzink.com" class="email">tzink@terryzink.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marc Bradshaw</span></div>
<div dir="auto" class="left"><span class="org">Fastmail</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marc@fastmailteam.com" class="email">marc@fastmailteam.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alex Brotman (ed)</span></div>
<div dir="auto" class="left"><span class="org">Comcast</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alex_brotman@comcast.com" class="email">alex_brotman@comcast.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
